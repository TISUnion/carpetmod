--- a/net/minecraft/block/BlockFalling.java
+++ b/net/minecraft/block/BlockFalling.java
@@ -1,6 +1,8 @@
 package net.minecraft.block;
 
 import java.util.Random;
+
+import carpet.settings.CarpetSettings;
 import net.minecraft.block.material.Material;
 import net.minecraft.block.state.IBlockState;
 import net.minecraft.entity.item.EntityFallingBlock;
@@ -53,9 +55,22 @@
             {
                 if (!worldIn.isRemote)
                 {
-                    EntityFallingBlock entityfallingblock = new EntityFallingBlock(worldIn, (double)pos.getX() + 0.5D, (double)pos.getY(), (double)pos.getZ() + 0.5D, worldIn.getBlockState(pos));
-                    this.onStartFalling(entityfallingblock);
-                    worldIn.spawnEntity(entityfallingblock);
+                    // TISCM - fallingBlockSwapAttempt - added branch
+                    if (CarpetSettings.fallingBlockSwapAttempts <= 0) {
+                        EntityFallingBlock entityfallingblock = new EntityFallingBlock(worldIn, (double) pos.getX() + 0.5D, (double) pos.getY(), (double) pos.getZ() + 0.5D, worldIn.getBlockState(pos));
+                        this.onStartFalling(entityfallingblock);
+                        worldIn.spawnEntity(entityfallingblock);
+                    } else {
+                        int fbs = Math.min(CarpetSettings.fallingBlockSwapAttempts, 1 << 20);
+                        IBlockState iBlockState = null;
+                        for (int j = 0; j < fbs; j ++) {
+                            iBlockState = worldIn.getBlockState(pos);
+                            if (iBlockState.getBlock() != this) break;
+                        }
+                        EntityFallingBlock entityFallingBlock = new EntityFallingBlock(worldIn, pos.getX() + 0.5D, pos.getY(), pos.getZ() + 0.5D, iBlockState);
+                        this.onStartFalling(entityFallingBlock);
+                        worldIn.spawnEntity(entityFallingBlock);
+                    }
                 }
             }
             else
